```html
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>產品銷售受美國關稅、原產地認證影響調查</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div class="bg-white p-8 rounded-lg shadow-lg w-full max-w-4xl">
        <h1 class="text-2xl font-bold mb-4 text-center">產品銷售受美國關稅、原產地認證影響調查</h1>
        <div class="text-sm text-gray-600 mb-6">
            <p>隨著美國針對進口商品實施加徵關稅、強化原產地認證及防止規避性貿易行為的政策持續推進，國際品牌客戶亦日益重視供應鏈透明度與合規要求。為掌握本公司在不同產品線與客戶組合中，實際面臨的關稅成本壓力與原產地證明需求，並據以協助公司研擬因應策略，特針對各事業單位進行本次問卷調查。</p>
            <p class="mt-2">本問卷目的為：</p>
            <ul class="list-disc ml-4">
                <li>彙總各產品線對美出口實況與潛在政策風險；</li>
                <li>盤點客戶對原產地證明、關稅分擔等要求；</li>
                <li>協助公司高階管理團隊進行策略評估與資源配置。</li>
            </ul>
        </div>
        <form id="surveyForm" class="space-y-6">
            <!-- 題目 1：填表人資訊 -->
            <div class="border p-4 rounded-md">
                <h2 class="text-lg font-semibold mb-4">1. 填表人資訊</h2>
                <div class="space-y-4">
                    <div>
                        <label>(1) 填表人姓名：</label>
                        <input type="text" name="respondentName" class="w-full rounded-md border-gray-300 bg-gray-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                    </div>
                    <div>
                        <label>(2) email：</label>
                        <input type="email" name="respondentEmail" class="w-full rounded-md border-gray-300 bg-gray-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                    </div>
                    <div>
                        <label>(3) 連絡電話：</label>
                        <input type="tel" name="respondentPhone" class="w-full rounded-md border-gray-300 bg-gray-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                    </div>
                </div>
            </div>

            <!-- 題目 2：填報產品類別與主要客戶數量 -->
            <div id="section2" class="border p-4 rounded-md">
                <h2 class="text-lg font-semibold mb-2">2. 填報產品類別與主要客戶數量</h2>
                <p class="text-sm italic text-gray-600 mb-4">*主要客戶數量以佔該類別產品營收5%以上為主</p>
                <div id="productCategories" class="space-y-4">
                    <div class="flex items-center space-x-4">
                        <label class="w-48">固聚酯粒，主要客戶數量：</label>
                        <input type="number" name="customerCount" data-category="固聚酯粒" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0">
                    </div>
                    <div class="flex items-center space-x-4">
                        <label class="w-48">PET瓶，主要客戶數量：</label>
                        <input type="number" name="customerCount" data-category="PET瓶" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0">
                    </div>
                    <div class="flex items-center space-x-4">
                        <label class="w-48">聚酯膠片，主要客戶數量：</label>
                        <input type="number" name="customerCount" data-category="聚酯膠片" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0">
                    </div>
                    <div class="flex items-center space-x-4">
                        <label class="w-48">聚酯膜，主要客戶數量：</label>
                        <input type="number" name="customerCount" data-category="聚酯膜" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0">
                    </div>
                    <div class="flex items-center space-x-4">
                        <label class="w-48">加工絲，主要客戶數量：</label>
                        <input type="number" name="customerCount" data-category="加工絲" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0">
                    </div>
                    <div class="flex items-center space-x-4">
                        <label class="w-48">棉酯粒，主要客戶數量：</label>
                        <input type="number" name="customerCount" data-category="棉酯粒" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0">
                    </div>
                    <div class="flex items-center space-x-4">
                        <label class="w-48">絲酯粒，主要客戶數量：</label>
                        <input type="number" name="customerCount" data-category="絲酯粒" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0">
                    </div>
                    <div class="flex items-center space-x-4">
                        <label class="w-48">紗，主要客戶數量：</label>
                        <input type="number" name="customerCount" data-category="紗" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0">
                    </div>
                    <div class="flex items-center space-x-4">
                        <label class="w-48">織染，主要客戶數量：</label>
                        <input type="number" name="customerCount" data-category="織染" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0">
                    </div>
                    <div class="flex items-center space-x-4">
                        <label class="w-48">成衣，主要客戶數量：</label>
                        <input type="number" name="customerCount" data-category="成衣" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0">
                    </div>
                </div>
                <button type="button" id="generateCustomerSurvey" class="mt-4 w-full bg-green-500 text-white py-2 rounded-md hover:bg-green-600">下一題</button>
            </div>

            <!-- 題目 3：客戶銷售情形調查 -->
            <div id="customerSurvey" class="border p-4 rounded-md hidden">
                <h2 class="text-lg font-semibold mb-4">3. 客戶銷售情形調查</h2>
                <div id="customerEntries"></div>
                <button type="button" id="showSection4" class="mt-4 w-full bg-green-500 text-white py-2 rounded-md hover:bg-green-600">下一題</button>
            </div>

            <!-- 題目 4：開放式問題 -->
            <div id="section4" class="border p-4 rounded-md hidden">
                <h2 class="text-lg font-semibold mb-4">4. 目前貴單位針對美國關稅是否有遇到較特殊情形或客戶額外特別要求，請補充說明</h2>
                <div>
                    <textarea name="specialCircumstances" class="w-full rounded-md border-gray-300 bg-gray-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" rows="4"></textarea>
                </div>
            </div>

            <button type="submit" class="w-full bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 hidden" id="submitButton">提交問卷</button>
        </form>
    </div>

    <script>
        // 產品類別列表
        const categories = [
            '固聚酯粒', 'PET瓶', '聚酯膠片', '聚酯膜', '加工絲',
            '棉酯粒', '絲酯粒', '紗', '織染', '成衣'
        ];

        // 動態生成客戶調查題組（題組三）
        function generateCustomerEntries() {
            const customerEntries = document.getElementById('customerEntries');
            customerEntries.innerHTML = ''; // 清空現有內容
            let hasEntries = false;

            categories.forEach(category => {
                const countInput = document.querySelector(`input[data-category="${category}"]`);
                const customerCount = parseInt(countInput.value) || 0;

                if (customerCount > 0) {
                    hasEntries = true;
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'mb-6';
                    categoryDiv.innerHTML = `<h3 class="text-md font-medium mb-2">${category}</h3>`;
                    for (let i = 1; i <= customerCount; i++) {
                        const entryDiv = document.createElement('div');
                        entryDiv.className = 'customer-entry mb-4 border p-4 rounded-md';
                        entryDiv.setAttribute('data-category', category);
                        entryDiv.setAttribute('data-customer', i);
                        entryDiv.innerHTML = `
                            <h4 class="text-sm font-medium mb-2">${category} 客戶${i}</h4>
                            <div class="space-y-2">
                                <div>
                                    <label>(1) 客戶名稱：</label>
                                    <input type="text" name="customerName" class="w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                                </div>
                                <div>
                                    <label>(2) 該客戶占我司本類別產品銷售比重%(可為概估值)：</label>
                                    <input type="number" name="salesPercentage" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0" max="100" required>
                                </div>
                                <div>
                                    <label>(3) 我司是否直接出口至美國，供貨予客戶：</label>
                                    <select name="exportToUS" class="rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                                        <option value="" selected>請選擇</option>
                                        <option value="是">是</option>
                                        <option value="否">否</option>
                                    </select>
                                </div>
                                <div class="exportPercentage hidden">
                                    <label>(4) 該客戶產品出口美國市場比重%(可為概估值)：</label>
                                    <input type="number" name="exportPercentage" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0" max="100">
                                </div>
                                <div class="tariffSection hidden">
                                    <label>(5) 客戶要求關稅分擔比重%為何?(無則填0)：</label>
                                    <input type="number" name="tariffShare" class="w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" min="0" max="100" value="0" required>
                                </div>
                                <div class="tariffSection hidden">
                                    <label>(6) 客戶是否要求提供產地證明？：</label>
                                    <select name="certificateRequired" class="rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                                        <option value="是">是</option>
                                        <option value="否">否</option>
                                    </select>
                                </div>
                                <div class="tariffSection hidden">
                                    <label>(7) 針對該客戶要求關稅分擔、提供產地證明，目前採取應對措施：</label>
                                    <textarea name="measures" class="w-full rounded-md border-gray-300 bg-gray-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea>
                                </div>
                            </div>
                        `;
                        categoryDiv.appendChild(entryDiv);
                    }
                    customerEntries.appendChild(categoryDiv);
                }
            });

            // 顯示或隱藏題組三
            const customerSurvey = document.getElementById('customerSurvey');
            customerSurvey.classList.toggle('hidden', !hasEntries);
        }

        // 點擊題組二「下一題」按鈕
        document.getElementById('generateCustomerSurvey').addEventListener('click', () => {
            // 將未填寫的客戶數量設為 0
            document.querySelectorAll('input[name="customerCount"]').forEach(input => {
                if (input.value === '' || input.value === null) {
                    input.value = 0;
                }
            });
            generateCustomerEntries();
        });

        // 點擊題組三「下一題」按鈕
        document.getElementById('showSection4').addEventListener('click', () => {
            const section4 = document.getElementById('section4');
            const submitButton = document.getElementById('submitButton');
            section4.classList.remove('hidden');
            submitButton.classList.remove('hidden');
        });

        // 動態更新題組三跳題邏輯
        document.getElementById('surveyForm').addEventListener('change', (e) => {
            if (e.target.name === 'exportToUS') {
                const customerEntry = e.target.closest('.customer-entry');
                const exportPercentageDiv = customerEntry.querySelector('.exportPercentage');
                const tariffSectionDivs = customerEntry.querySelectorAll('.tariffSection');
                if (e.target.value === '是') {
                    exportPercentageDiv.classList.add('hidden');
                    tariffSectionDivs.forEach(div => div.classList.remove('hidden'));
                } else if (e.target.value === '否') {
                    exportPercentageDiv.classList.remove('hidden');
                    tariffSectionDivs.forEach(div => div.classList.add('hidden'));
                    const exportPercentageInput = customerEntry.querySelector('input[name="exportPercentage"]');
                    exportPercentageInput.value = '';
                } else {
                    // 預設「請選擇」時隱藏所有後續問題
                    exportPercentageDiv.classList.add('hidden');
                    tariffSectionDivs.forEach(div => div.classList.add('hidden'));
                }
            } else if (e.target.name === 'exportPercentage') {
                const customerEntry = e.target.closest('.customer-entry');
                const tariffSectionDivs = customerEntry.querySelectorAll('.tariffSection');
                const value = parseFloat(e.target.value) || 0;
                tariffSectionDivs.forEach(div => div.classList.toggle('hidden', value === 0));
            }
        });

        // 表單提交
        document.getElementById('surveyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                respondent: {
                    name: document.querySelector('input[name="respondentName"]').value,
                    email: document.querySelector('input[name="respondentEmail"]').value,
                    phone: document.querySelector('input[name="respondentPhone"]').value
                },
                categories: {},
                customers: {},
                specialCircumstances: document.querySelector('textarea[name="specialCircumstances"]').value
            };

            // 收集題目 2 數據
            categories.forEach(category => {
                const countInput = document.querySelector(`input[data-category="${category}"]`);
                data.categories[category] = parseInt(countInput.value) || 0;
            });

            // 收集題目 3 數據
            const customerEntries = document.querySelectorAll('.customer-entry');
            customerEntries.forEach(entry => {
                const category = entry.getAttribute('data-category');
                const customerId = entry.getAttribute('data-customer');
                if (!data.customers[category]) data.customers[category] = [];
                data.customers[category].push({
                    customerName: entry.querySelector('input[name="customerName"]').value,
                    salesPercentage: parseFloat(entry.querySelector('input[name="salesPercentage"]').value) || 0,
                    exportToUS: entry.querySelector('select[name="exportToUS"]').value,
                    exportPercentage: parseFloat(entry.querySelector('input[name="exportPercentage"]').value) || 0,
                    tariffShare: parseFloat(entry.querySelector('input[name="tariffShare"]').value) || 0,
                    certificateRequired: entry.querySelector('select[name="certificateRequired"]').value,
                    measures: entry.querySelector('textarea[name="measures"]').value
                });
            });

            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbwbOVZIshv20A3aFBr46-e_zT5gtdafcf2-JIK4LRzenarosZwLSYmcxMDJMoXOOORP/exec', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const result = await response.json();
                if (result.status === 'success') {
                    alert('問卷已提交！數據已儲存至試算表。');
                } else {
                    alert('提交失敗，請稍後再試！');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('提交失敗，請檢查網路連線！');
            }
        });
    </script>
</body>
</html>
```